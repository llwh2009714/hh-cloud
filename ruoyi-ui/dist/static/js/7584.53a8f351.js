"use strict";(self["webpackChunkruoyi"]=self["webpackChunkruoyi"]||[]).push([[7584],{17584:function(e,t,a){a.r(t),a.d(t,{default:function(){return ue}});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0,"label-width":"68px"}},[a("el-form-item",{attrs:{label:"任务名称",prop:"jobName"}},[a("el-input",{attrs:{placeholder:"请输入任务名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.jobName,callback:function(t){e.$set(e.queryParams,"jobName",t)},expression:"queryParams.jobName"}})],1),a("el-form-item",{attrs:{label:"任务组名",prop:"jobGroup"}},[a("el-select",{attrs:{placeholder:"请选择任务组名",clearable:""},model:{value:e.queryParams.jobGroup,callback:function(t){e.$set(e.queryParams,"jobGroup",t)},expression:"queryParams.jobGroup"}},e._l(e.dict.type.sys_job_group,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"任务状态",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择任务状态",clearable:""},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},e._l(e.dict.type.sys_job_status,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:add"],expression:"['monitor:job:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAdd}},[e._v("新增")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:edit"],expression:"['monitor:job:edit']"}],attrs:{type:"success",plain:"",icon:"el-icon-edit",size:"mini",disabled:e.single},on:{click:e.handleUpdate}},[e._v("修改")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:remove"],expression:"['monitor:job:remove']"}],attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"mini",disabled:e.multiple},on:{click:e.handleDelete}},[e._v("删除")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:export"],expression:"['monitor:job:export']"}],attrs:{type:"warning",plain:"",icon:"el-icon-download",size:"mini"},on:{click:e.handleExport}},[e._v("导出")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:query"],expression:"['monitor:job:query']"}],attrs:{type:"info",plain:"",icon:"el-icon-s-operation",size:"mini"},on:{click:e.handleJobLog}},[e._v("日志")])],1),a("right-toolbar",{attrs:{showSearch:e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.jobList},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{label:"任务编号",width:"100",align:"center",prop:"jobId"}}),a("el-table-column",{attrs:{label:"任务名称",align:"center",prop:"jobName","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"任务组名",align:"center",prop:"jobGroup"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("dict-tag",{attrs:{options:e.dict.type.sys_job_group,value:t.row.jobGroup}})]}}])}),a("el-table-column",{attrs:{label:"调用目标字符串",align:"center",prop:"invokeTarget","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"cron执行表达式",align:"center",prop:"cronExpression","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-value":"0","inactive-value":"1"},on:{change:function(a){return e.handleStatusChange(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}})]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:edit"],expression:"['monitor:job:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("修改")]),a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:remove"],expression:"['monitor:job:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")]),a("el-dropdown",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:changeStatus","monitor:job:query"],expression:"['monitor:job:changeStatus', 'monitor:job:query']"}],attrs:{size:"mini"},on:{command:function(a){return e.handleCommand(a,t.row)}}},[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-d-arrow-right"}},[e._v("更多")]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:changeStatus"],expression:"['monitor:job:changeStatus']"}],attrs:{command:"handleRun",icon:"el-icon-caret-right"}},[e._v("执行一次")]),a("el-dropdown-item",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:query"],expression:"['monitor:job:query']"}],attrs:{command:"handleView",icon:"el-icon-view"}},[e._v("任务详细")]),a("el-dropdown-item",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:query"],expression:"['monitor:job:query']"}],attrs:{command:"handleJobLog",icon:"el-icon-s-operation"}},[e._v("调度日志")])],1)],1)]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),a("el-dialog",{attrs:{title:e.title,visible:e.open,width:"800px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"任务名称",prop:"jobName"}},[a("el-input",{attrs:{placeholder:"请输入任务名称"},model:{value:e.form.jobName,callback:function(t){e.$set(e.form,"jobName",t)},expression:"form.jobName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"任务分组",prop:"jobGroup"}},[a("el-select",{attrs:{placeholder:"请选择任务分组"},model:{value:e.form.jobGroup,callback:function(t){e.$set(e.form,"jobGroup",t)},expression:"form.jobGroup"}},e._l(e.dict.type.sys_job_group,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"invokeTarget"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" 调用方法 "),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" Bean调用示例：ryTask.ryParams('ry') "),a("br"),e._v("Class类调用示例：com.ruoyi.quartz.task.RyTask.ryParams('ry') "),a("br"),e._v("参数说明：支持字符串，布尔类型，长整型，浮点型，整型 ")]),a("i",{staticClass:"el-icon-question"})])],1),a("el-input",{attrs:{placeholder:"请输入调用目标字符串"},model:{value:e.form.invokeTarget,callback:function(t){e.$set(e.form,"invokeTarget",t)},expression:"form.invokeTarget"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"cron表达式",prop:"cronExpression"}},[a("el-input",{attrs:{placeholder:"请输入cron执行表达式"},model:{value:e.form.cronExpression,callback:function(t){e.$set(e.form,"cronExpression",t)},expression:"form.cronExpression"}},[a("template",{slot:"append"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleShowCron}},[e._v(" 生成表达式 "),a("i",{staticClass:"el-icon-time el-icon--right"})])],1)],2)],1)],1),void 0!==e.form.jobId?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.dict.type.sys_job_status,(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1)],1):e._e(),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"执行策略",prop:"misfirePolicy"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.form.misfirePolicy,callback:function(t){e.$set(e.form,"misfirePolicy",t)},expression:"form.misfirePolicy"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v("立即执行")]),a("el-radio-button",{attrs:{label:"2"}},[e._v("执行一次")]),a("el-radio-button",{attrs:{label:"3"}},[e._v("放弃执行")])],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"是否并发",prop:"concurrent"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.form.concurrent,callback:function(t){e.$set(e.form,"concurrent",t)},expression:"form.concurrent"}},[a("el-radio-button",{attrs:{label:"0"}},[e._v("允许")]),a("el-radio-button",{attrs:{label:"1"}},[e._v("禁止")])],1)],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1),a("el-dialog",{staticClass:"scrollbar",attrs:{title:"Cron表达式生成器",visible:e.openCron,"append-to-body":"","destroy-on-close":""},on:{"update:visible":function(t){e.openCron=t}}},[a("crontab",{attrs:{expression:e.expression},on:{hide:function(t){e.openCron=!1},fill:e.crontabFill}})],1),a("el-dialog",{attrs:{title:"任务详细",visible:e.openView,width:"700px","append-to-body":""},on:{"update:visible":function(t){e.openView=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px",size:"mini"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"任务编号："}},[e._v(e._s(e.form.jobId))]),a("el-form-item",{attrs:{label:"任务名称："}},[e._v(e._s(e.form.jobName))])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"任务分组："}},[e._v(e._s(e.jobGroupFormat(e.form)))]),a("el-form-item",{attrs:{label:"创建时间："}},[e._v(e._s(e.form.createTime))])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"cron表达式："}},[e._v(e._s(e.form.cronExpression))])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"下次执行时间："}},[e._v(e._s(e.parseTime(e.form.nextValidTime)))])],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"调用目标方法："}},[e._v(e._s(e.form.invokeTarget))])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"任务状态："}},[0==e.form.status?a("div",[e._v("正常")]):1==e.form.status?a("div",[e._v("暂停")]):e._e()])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"是否并发："}},[0==e.form.concurrent?a("div",[e._v("允许")]):1==e.form.concurrent?a("div",[e._v("禁止")]):e._e()])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"执行策略："}},[0==e.form.misfirePolicy?a("div",[e._v("默认策略")]):1==e.form.misfirePolicy?a("div",[e._v("立即执行")]):2==e.form.misfirePolicy?a("div",[e._v("执行一次")]):3==e.form.misfirePolicy?a("div",[e._v("放弃执行")]):e._e()])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.openView=!1}}},[e._v("关 闭")])],1)],1)],1)},l=[],i=(a(28743),a(5830)),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{attrs:{type:"border-card"}},[e.shouldHide("second")?a("el-tab-pane",{attrs:{label:"秒"}},[a("CrontabSecond",{ref:"cronsecond",attrs:{check:e.checkNumber,cron:e.crontabValueObj},on:{update:e.updateCrontabValue}})],1):e._e(),e.shouldHide("min")?a("el-tab-pane",{attrs:{label:"分钟"}},[a("CrontabMin",{ref:"cronmin",attrs:{check:e.checkNumber,cron:e.crontabValueObj},on:{update:e.updateCrontabValue}})],1):e._e(),e.shouldHide("hour")?a("el-tab-pane",{attrs:{label:"小时"}},[a("CrontabHour",{ref:"cronhour",attrs:{check:e.checkNumber,cron:e.crontabValueObj},on:{update:e.updateCrontabValue}})],1):e._e(),e.shouldHide("day")?a("el-tab-pane",{attrs:{label:"日"}},[a("CrontabDay",{ref:"cronday",attrs:{check:e.checkNumber,cron:e.crontabValueObj},on:{update:e.updateCrontabValue}})],1):e._e(),e.shouldHide("month")?a("el-tab-pane",{attrs:{label:"月"}},[a("CrontabMonth",{ref:"cronmonth",attrs:{check:e.checkNumber,cron:e.crontabValueObj},on:{update:e.updateCrontabValue}})],1):e._e(),e.shouldHide("week")?a("el-tab-pane",{attrs:{label:"周"}},[a("CrontabWeek",{ref:"cronweek",attrs:{check:e.checkNumber,cron:e.crontabValueObj},on:{update:e.updateCrontabValue}})],1):e._e(),e.shouldHide("year")?a("el-tab-pane",{attrs:{label:"年"}},[a("CrontabYear",{ref:"cronyear",attrs:{check:e.checkNumber,cron:e.crontabValueObj},on:{update:e.updateCrontabValue}})],1):e._e()],1),a("div",{staticClass:"popup-main"},[a("div",{staticClass:"popup-result"},[a("p",{staticClass:"title"},[e._v("时间表达式")]),a("table",[a("thead",[e._l(e.tabTitles,(function(t){return a("th",{key:t,attrs:{width:"40"}},[e._v(e._s(t))])})),a("th",[e._v("Cron 表达式")])],2),a("tbody",[a("td",[a("span",[e._v(e._s(e.crontabValueObj.second))])]),a("td",[a("span",[e._v(e._s(e.crontabValueObj.min))])]),a("td",[a("span",[e._v(e._s(e.crontabValueObj.hour))])]),a("td",[a("span",[e._v(e._s(e.crontabValueObj.day))])]),a("td",[a("span",[e._v(e._s(e.crontabValueObj.month))])]),a("td",[a("span",[e._v(e._s(e.crontabValueObj.week))])]),a("td",[a("span",[e._v(e._s(e.crontabValueObj.year))])]),a("td",[a("span",[e._v(e._s(e.crontabValueString))])])])])]),a("CrontabResult",{attrs:{ex:e.crontabValueString}}),a("div",{staticClass:"pop_btn"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitFill}},[e._v("确定")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.clearCron}},[e._v("重置")]),a("el-button",{attrs:{size:"small"},on:{click:e.hidePopup}},[e._v("取消")])],1)],1)],1)},s=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{size:"small"}},[a("el-form-item",[a("el-radio",{attrs:{label:1},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 秒，允许的通配符[, - * /] ")])],1),a("el-form-item",[a("el-radio",{attrs:{label:2},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 周期从 "),a("el-input-number",{attrs:{min:0,max:58},model:{value:e.cycle01,callback:function(t){e.cycle01=t},expression:"cycle01"}}),e._v(" - "),a("el-input-number",{attrs:{min:e.cycle01?e.cycle01+1:1,max:59},model:{value:e.cycle02,callback:function(t){e.cycle02=t},expression:"cycle02"}}),e._v(" 秒 ")],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:3},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 从 "),a("el-input-number",{attrs:{min:0,max:58},model:{value:e.average01,callback:function(t){e.average01=t},expression:"average01"}}),e._v(" 秒开始，每 "),a("el-input-number",{attrs:{min:1,max:59-e.average01||0},model:{value:e.average02,callback:function(t){e.average02=t},expression:"average02"}}),e._v(" 秒执行一次 ")],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:4},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 指定 "),a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"可多选",multiple:""},model:{value:e.checkboxList,callback:function(t){e.checkboxList=t},expression:"checkboxList"}},e._l(60,(function(t){return a("el-option",{key:t,attrs:{value:t-1}},[e._v(e._s(t-1))])})),1)],1)],1)],1)},c=[],u={data(){return{radioValue:1,cycle01:1,cycle02:2,average01:0,average02:1,checkboxList:[],checkNum:this.$options.propsData.check}},name:"crontab-second",props:["check","radioParent"],methods:{radioChange(){switch(this.radioValue){case 1:this.$emit("update","second","*","second");break;case 2:this.$emit("update","second",this.cycleTotal);break;case 3:this.$emit("update","second",this.averageTotal);break;case 4:this.$emit("update","second",this.checkboxString);break}},cycleChange(){"2"==this.radioValue&&this.$emit("update","second",this.cycleTotal)},averageChange(){"3"==this.radioValue&&this.$emit("update","second",this.averageTotal)},checkboxChange(){"4"==this.radioValue&&this.$emit("update","second",this.checkboxString)}},watch:{radioValue:"radioChange",cycleTotal:"cycleChange",averageTotal:"averageChange",checkboxString:"checkboxChange",radioParent(){this.radioValue=this.radioParent}},computed:{cycleTotal:function(){const e=this.checkNum(this.cycle01,0,58),t=this.checkNum(this.cycle02,e?e+1:1,59);return e+"-"+t},averageTotal:function(){const e=this.checkNum(this.average01,0,58),t=this.checkNum(this.average02,1,59-e||0);return e+"/"+t},checkboxString:function(){let e=this.checkboxList.join();return""==e?"*":e}}},h=u,d=a(81656),m=(0,d.A)(h,n,c,!1,null,null,null),p=m.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{size:"small"}},[a("el-form-item",[a("el-radio",{attrs:{label:1},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 分钟，允许的通配符[, - * /] ")])],1),a("el-form-item",[a("el-radio",{attrs:{label:2},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 周期从 "),a("el-input-number",{attrs:{min:0,max:58},model:{value:e.cycle01,callback:function(t){e.cycle01=t},expression:"cycle01"}}),e._v(" - "),a("el-input-number",{attrs:{min:e.cycle01?e.cycle01+1:1,max:59},model:{value:e.cycle02,callback:function(t){e.cycle02=t},expression:"cycle02"}}),e._v(" 分钟 ")],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:3},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 从 "),a("el-input-number",{attrs:{min:0,max:58},model:{value:e.average01,callback:function(t){e.average01=t},expression:"average01"}}),e._v(" 分钟开始，每 "),a("el-input-number",{attrs:{min:1,max:59-e.average01||0},model:{value:e.average02,callback:function(t){e.average02=t},expression:"average02"}}),e._v(" 分钟执行一次 ")],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:4},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 指定 "),a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"可多选",multiple:""},model:{value:e.checkboxList,callback:function(t){e.checkboxList=t},expression:"checkboxList"}},e._l(60,(function(t){return a("el-option",{key:t,attrs:{value:t-1}},[e._v(e._s(t-1))])})),1)],1)],1)],1)},v=[],f={data(){return{radioValue:1,cycle01:1,cycle02:2,average01:0,average02:1,checkboxList:[],checkNum:this.$options.propsData.check}},name:"crontab-min",props:["check","cron"],methods:{radioChange(){switch(this.radioValue){case 1:this.$emit("update","min","*","min");break;case 2:this.$emit("update","min",this.cycleTotal,"min");break;case 3:this.$emit("update","min",this.averageTotal,"min");break;case 4:this.$emit("update","min",this.checkboxString,"min");break}},cycleChange(){"2"==this.radioValue&&this.$emit("update","min",this.cycleTotal,"min")},averageChange(){"3"==this.radioValue&&this.$emit("update","min",this.averageTotal,"min")},checkboxChange(){"4"==this.radioValue&&this.$emit("update","min",this.checkboxString,"min")}},watch:{radioValue:"radioChange",cycleTotal:"cycleChange",averageTotal:"averageChange",checkboxString:"checkboxChange"},computed:{cycleTotal:function(){const e=this.checkNum(this.cycle01,0,58),t=this.checkNum(this.cycle02,e?e+1:1,59);return e+"-"+t},averageTotal:function(){const e=this.checkNum(this.average01,0,58),t=this.checkNum(this.average02,1,59-e||0);return e+"/"+t},checkboxString:function(){let e=this.checkboxList.join();return""==e?"*":e}}},g=f,k=(0,d.A)(g,b,v,!1,null,null,null),y=k.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{size:"small"}},[a("el-form-item",[a("el-radio",{attrs:{label:1},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 小时，允许的通配符[, - * /] ")])],1),a("el-form-item",[a("el-radio",{attrs:{label:2},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 周期从 "),a("el-input-number",{attrs:{min:0,max:22},model:{value:e.cycle01,callback:function(t){e.cycle01=t},expression:"cycle01"}}),e._v(" - "),a("el-input-number",{attrs:{min:e.cycle01?e.cycle01+1:1,max:23},model:{value:e.cycle02,callback:function(t){e.cycle02=t},expression:"cycle02"}}),e._v(" 小时 ")],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:3},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 从 "),a("el-input-number",{attrs:{min:0,max:22},model:{value:e.average01,callback:function(t){e.average01=t},expression:"average01"}}),e._v(" 小时开始，每 "),a("el-input-number",{attrs:{min:1,max:23-e.average01||0},model:{value:e.average02,callback:function(t){e.average02=t},expression:"average02"}}),e._v(" 小时执行一次 ")],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:4},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 指定 "),a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"可多选",multiple:""},model:{value:e.checkboxList,callback:function(t){e.checkboxList=t},expression:"checkboxList"}},e._l(24,(function(t){return a("el-option",{key:t,attrs:{value:t-1}},[e._v(e._s(t-1))])})),1)],1)],1)],1)},_=[],V={data(){return{radioValue:1,cycle01:0,cycle02:1,average01:0,average02:1,checkboxList:[],checkNum:this.$options.propsData.check}},name:"crontab-hour",props:["check","cron"],methods:{radioChange(){switch(this.radioValue){case 1:this.$emit("update","hour","*");break;case 2:this.$emit("update","hour",this.cycleTotal);break;case 3:this.$emit("update","hour",this.averageTotal);break;case 4:this.$emit("update","hour",this.checkboxString);break}},cycleChange(){"2"==this.radioValue&&this.$emit("update","hour",this.cycleTotal)},averageChange(){"3"==this.radioValue&&this.$emit("update","hour",this.averageTotal)},checkboxChange(){"4"==this.radioValue&&this.$emit("update","hour",this.checkboxString)}},watch:{radioValue:"radioChange",cycleTotal:"cycleChange",averageTotal:"averageChange",checkboxString:"checkboxChange"},computed:{cycleTotal:function(){const e=this.checkNum(this.cycle01,0,22),t=this.checkNum(this.cycle02,e?e+1:1,23);return e+"-"+t},averageTotal:function(){const e=this.checkNum(this.average01,0,22),t=this.checkNum(this.average02,1,23-e||0);return e+"/"+t},checkboxString:function(){let e=this.checkboxList.join();return""==e?"*":e}}},w=V,$=(0,d.A)(w,x,_,!1,null,null,null),C=$.exports,j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{size:"small"}},[a("el-form-item",[a("el-radio",{attrs:{label:1},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 日，允许的通配符[, - * ? / L W] ")])],1),a("el-form-item",[a("el-radio",{attrs:{label:2},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 不指定 ")])],1),a("el-form-item",[a("el-radio",{attrs:{label:3},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 周期从 "),a("el-input-number",{attrs:{min:1,max:30},model:{value:e.cycle01,callback:function(t){e.cycle01=t},expression:"cycle01"}}),e._v(" - "),a("el-input-number",{attrs:{min:e.cycle01?e.cycle01+1:2,max:31},model:{value:e.cycle02,callback:function(t){e.cycle02=t},expression:"cycle02"}}),e._v(" 日 ")],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:4},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 从 "),a("el-input-number",{attrs:{min:1,max:30},model:{value:e.average01,callback:function(t){e.average01=t},expression:"average01"}}),e._v(" 号开始，每 "),a("el-input-number",{attrs:{min:1,max:31-e.average01||1},model:{value:e.average02,callback:function(t){e.average02=t},expression:"average02"}}),e._v(" 日执行一次 ")],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:5},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 每月 "),a("el-input-number",{attrs:{min:1,max:31},model:{value:e.workday,callback:function(t){e.workday=t},expression:"workday"}}),e._v(" 号最近的那个工作日 ")],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:6},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 本月最后一天 ")])],1),a("el-form-item",[a("el-radio",{attrs:{label:7},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 指定 "),a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"可多选",multiple:""},model:{value:e.checkboxList,callback:function(t){e.checkboxList=t},expression:"checkboxList"}},e._l(31,(function(t){return a("el-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1)],1)],1)},A=[],S={data(){return{radioValue:1,workday:1,cycle01:1,cycle02:2,average01:1,average02:1,checkboxList:[],checkNum:this.$options.propsData.check}},name:"crontab-day",props:["check","cron"],methods:{radioChange(){switch(2!==this.radioValue&&"?"!==this.cron.week&&this.$emit("update","week","?","day"),this.radioValue){case 1:this.$emit("update","day","*");break;case 2:this.$emit("update","day","?");break;case 3:this.$emit("update","day",this.cycleTotal);break;case 4:this.$emit("update","day",this.averageTotal);break;case 5:this.$emit("update","day",this.workday+"W");break;case 6:this.$emit("update","day","L");break;case 7:this.$emit("update","day",this.checkboxString);break}},cycleChange(){"3"==this.radioValue&&this.$emit("update","day",this.cycleTotal)},averageChange(){"4"==this.radioValue&&this.$emit("update","day",this.averageTotal)},workdayChange(){"5"==this.radioValue&&this.$emit("update","day",this.workdayCheck+"W")},checkboxChange(){"7"==this.radioValue&&this.$emit("update","day",this.checkboxString)}},watch:{radioValue:"radioChange",cycleTotal:"cycleChange",averageTotal:"averageChange",workdayCheck:"workdayChange",checkboxString:"checkboxChange"},computed:{cycleTotal:function(){const e=this.checkNum(this.cycle01,1,30),t=this.checkNum(this.cycle02,e?e+1:2,31,31);return e+"-"+t},averageTotal:function(){const e=this.checkNum(this.average01,1,30),t=this.checkNum(this.average02,1,31-e||0);return e+"/"+t},workdayCheck:function(){const e=this.checkNum(this.workday,1,31);return e},checkboxString:function(){let e=this.checkboxList.join();return""==e?"*":e}}},N=S,L=(0,d.A)(N,j,A,!1,null,null,null),T=L.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{size:"small"}},[a("el-form-item",[a("el-radio",{attrs:{label:1},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 月，允许的通配符[, - * /] ")])],1),a("el-form-item",[a("el-radio",{attrs:{label:2},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 周期从 "),a("el-input-number",{attrs:{min:1,max:11},model:{value:e.cycle01,callback:function(t){e.cycle01=t},expression:"cycle01"}}),e._v(" - "),a("el-input-number",{attrs:{min:e.cycle01?e.cycle01+1:2,max:12},model:{value:e.cycle02,callback:function(t){e.cycle02=t},expression:"cycle02"}}),e._v(" 月 ")],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:3},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 从 "),a("el-input-number",{attrs:{min:1,max:11},model:{value:e.average01,callback:function(t){e.average01=t},expression:"average01"}}),e._v(" 月开始，每 "),a("el-input-number",{attrs:{min:1,max:12-e.average01||0},model:{value:e.average02,callback:function(t){e.average02=t},expression:"average02"}}),e._v(" 月月执行一次 ")],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:4},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 指定 "),a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"可多选",multiple:""},model:{value:e.checkboxList,callback:function(t){e.checkboxList=t},expression:"checkboxList"}},e._l(12,(function(t){return a("el-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1)],1)],1)},P=[],R={data(){return{radioValue:1,cycle01:1,cycle02:2,average01:1,average02:1,checkboxList:[],checkNum:this.check}},name:"crontab-month",props:["check","cron"],methods:{radioChange(){switch(this.radioValue){case 1:this.$emit("update","month","*");break;case 2:this.$emit("update","month",this.cycleTotal);break;case 3:this.$emit("update","month",this.averageTotal);break;case 4:this.$emit("update","month",this.checkboxString);break}},cycleChange(){"2"==this.radioValue&&this.$emit("update","month",this.cycleTotal)},averageChange(){"3"==this.radioValue&&this.$emit("update","month",this.averageTotal)},checkboxChange(){"4"==this.radioValue&&this.$emit("update","month",this.checkboxString)}},watch:{radioValue:"radioChange",cycleTotal:"cycleChange",averageTotal:"averageChange",checkboxString:"checkboxChange"},computed:{cycleTotal:function(){const e=this.checkNum(this.cycle01,1,11),t=this.checkNum(this.cycle02,e?e+1:2,12);return e+"-"+t},averageTotal:function(){const e=this.checkNum(this.average01,1,11),t=this.checkNum(this.average02,1,12-e||0);return e+"/"+t},checkboxString:function(){let e=this.checkboxList.join();return""==e?"*":e}}},D=R,q=(0,d.A)(D,O,P,!1,null,null,null),E=q.exports,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{size:"small"}},[a("el-form-item",[a("el-radio",{attrs:{label:1},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 周，允许的通配符[, - * ? / L #] ")])],1),a("el-form-item",[a("el-radio",{attrs:{label:2},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 不指定 ")])],1),a("el-form-item",[a("el-radio",{attrs:{label:3},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 周期从星期 "),a("el-select",{attrs:{clearable:""},model:{value:e.cycle01,callback:function(t){e.cycle01=t},expression:"cycle01"}},e._l(e.weekList,(function(t,r){return a("el-option",{key:r,attrs:{label:t.value,value:t.key,disabled:1===t.key}},[e._v(e._s(t.value))])})),1),e._v(" - "),a("el-select",{attrs:{clearable:""},model:{value:e.cycle02,callback:function(t){e.cycle02=t},expression:"cycle02"}},e._l(e.weekList,(function(t,r){return a("el-option",{key:r,attrs:{label:t.value,value:t.key,disabled:t.key<e.cycle01&&1!==t.key}},[e._v(e._s(t.value))])})),1)],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:4},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 第 "),a("el-input-number",{attrs:{min:1,max:4},model:{value:e.average01,callback:function(t){e.average01=t},expression:"average01"}}),e._v(" 周的星期 "),a("el-select",{attrs:{clearable:""},model:{value:e.average02,callback:function(t){e.average02=t},expression:"average02"}},e._l(e.weekList,(function(t,r){return a("el-option",{key:r,attrs:{label:t.value,value:t.key}},[e._v(e._s(t.value))])})),1)],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:5},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 本月最后一个星期 "),a("el-select",{attrs:{clearable:""},model:{value:e.weekday,callback:function(t){e.weekday=t},expression:"weekday"}},e._l(e.weekList,(function(t,r){return a("el-option",{key:r,attrs:{label:t.value,value:t.key}},[e._v(e._s(t.value))])})),1)],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:6},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 指定 "),a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"可多选",multiple:""},model:{value:e.checkboxList,callback:function(t){e.checkboxList=t},expression:"checkboxList"}},e._l(e.weekList,(function(t,r){return a("el-option",{key:r,attrs:{label:t.value,value:String(t.key)}},[e._v(e._s(t.value))])})),1)],1)],1)],1)},I=[],Y={data(){return{radioValue:2,weekday:2,cycle01:2,cycle02:3,average01:1,average02:2,checkboxList:[],weekList:[{key:2,value:"星期一"},{key:3,value:"星期二"},{key:4,value:"星期三"},{key:5,value:"星期四"},{key:6,value:"星期五"},{key:7,value:"星期六"},{key:1,value:"星期日"}],checkNum:this.$options.propsData.check}},name:"crontab-week",props:["check","cron"],methods:{radioChange(){switch(2!==this.radioValue&&"?"!==this.cron.day&&this.$emit("update","day","?","week"),this.radioValue){case 1:this.$emit("update","week","*");break;case 2:this.$emit("update","week","?");break;case 3:this.$emit("update","week",this.cycleTotal);break;case 4:this.$emit("update","week",this.averageTotal);break;case 5:this.$emit("update","week",this.weekdayCheck+"L");break;case 6:this.$emit("update","week",this.checkboxString);break}},cycleChange(){"3"==this.radioValue&&this.$emit("update","week",this.cycleTotal)},averageChange(){"4"==this.radioValue&&this.$emit("update","week",this.averageTotal)},weekdayChange(){"5"==this.radioValue&&this.$emit("update","week",this.weekday+"L")},checkboxChange(){"6"==this.radioValue&&this.$emit("update","week",this.checkboxString)}},watch:{radioValue:"radioChange",cycleTotal:"cycleChange",averageTotal:"averageChange",weekdayCheck:"weekdayChange",checkboxString:"checkboxChange"},computed:{cycleTotal:function(){return this.cycle01=this.checkNum(this.cycle01,1,7),this.cycle02=this.checkNum(this.cycle02,1,7),this.cycle01+"-"+this.cycle02},averageTotal:function(){return this.average01=this.checkNum(this.average01,1,4),this.average02=this.checkNum(this.average02,1,7),this.average02+"#"+this.average01},weekdayCheck:function(){return this.weekday=this.checkNum(this.weekday,1,7),this.weekday},checkboxString:function(){let e=this.checkboxList.join();return""==e?"*":e}}},G=Y,F=(0,d.A)(G,z,I,!1,null,null,null),W=F.exports,H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{size:"small"}},[a("el-form-item",[a("el-radio",{attrs:{label:1},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 不填，允许的通配符[, - * /] ")])],1),a("el-form-item",[a("el-radio",{attrs:{label:2},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 每年 ")])],1),a("el-form-item",[a("el-radio",{attrs:{label:3},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 周期从 "),a("el-input-number",{attrs:{min:e.fullYear,max:2098},model:{value:e.cycle01,callback:function(t){e.cycle01=t},expression:"cycle01"}}),e._v(" - "),a("el-input-number",{attrs:{min:e.cycle01?e.cycle01+1:e.fullYear+1,max:2099},model:{value:e.cycle02,callback:function(t){e.cycle02=t},expression:"cycle02"}})],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:4},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 从 "),a("el-input-number",{attrs:{min:e.fullYear,max:2098},model:{value:e.average01,callback:function(t){e.average01=t},expression:"average01"}}),e._v(" 年开始，每 "),a("el-input-number",{attrs:{min:1,max:2099-e.average01||e.fullYear},model:{value:e.average02,callback:function(t){e.average02=t},expression:"average02"}}),e._v(" 年执行一次 ")],1)],1),a("el-form-item",[a("el-radio",{attrs:{label:5},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}},[e._v(" 指定 "),a("el-select",{attrs:{clearable:"",placeholder:"可多选",multiple:""},model:{value:e.checkboxList,callback:function(t){e.checkboxList=t},expression:"checkboxList"}},e._l(9,(function(t){return a("el-option",{key:t,attrs:{value:t-1+e.fullYear,label:t-1+e.fullYear}})})),1)],1)],1)],1)},M=[],J={data(){return{fullYear:0,radioValue:1,cycle01:0,cycle02:0,average01:0,average02:1,checkboxList:[],checkNum:this.$options.propsData.check}},name:"crontab-year",props:["check","month","cron"],methods:{radioChange(){switch(this.radioValue){case 1:this.$emit("update","year","");break;case 2:this.$emit("update","year","*");break;case 3:this.$emit("update","year",this.cycleTotal);break;case 4:this.$emit("update","year",this.averageTotal);break;case 5:this.$emit("update","year",this.checkboxString);break}},cycleChange(){"3"==this.radioValue&&this.$emit("update","year",this.cycleTotal)},averageChange(){"4"==this.radioValue&&this.$emit("update","year",this.averageTotal)},checkboxChange(){"5"==this.radioValue&&this.$emit("update","year",this.checkboxString)}},watch:{radioValue:"radioChange",cycleTotal:"cycleChange",averageTotal:"averageChange",checkboxString:"checkboxChange"},computed:{cycleTotal:function(){const e=this.checkNum(this.cycle01,this.fullYear,2098),t=this.checkNum(this.cycle02,e?e+1:this.fullYear+1,2099);return e+"-"+t},averageTotal:function(){const e=this.checkNum(this.average01,this.fullYear,2098),t=this.checkNum(this.average02,1,2099-e||this.fullYear);return e+"/"+t},checkboxString:function(){let e=this.checkboxList.join();return e}},mounted:function(){this.fullYear=Number((new Date).getFullYear()),this.cycle01=this.fullYear,this.average01=this.fullYear}},Q=J,U=(0,d.A)(Q,H,M,!1,null,null,null),B=U.exports,K=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"popup-result"},[a("p",{staticClass:"title"},[e._v("最近5次运行时间")]),a("ul",{staticClass:"popup-result-scroll"},[e.isShow?e._l(e.resultList,(function(t){return a("li",{key:t},[e._v(e._s(t))])})):a("li",[e._v("计算结果中...")])],2)])},X=[],Z={data(){return{dayRule:"",dayRuleSup:"",dateArr:[],resultList:[],isShow:!1}},name:"crontab-result",methods:{expressionChange(){this.isShow=!1;let e=this.$options.propsData.ex.split(" "),t=0,a=[],r=new Date,l=r.getFullYear(),i=r.getMonth()+1,o=r.getDate(),s=r.getHours(),n=r.getMinutes(),c=r.getSeconds();this.getSecondArr(e[0]),this.getMinArr(e[1]),this.getHourArr(e[2]),this.getDayArr(e[3]),this.getMonthArr(e[4]),this.getWeekArr(e[5]),this.getYearArr(e[6],l);let u=this.dateArr[0],h=this.dateArr[1],d=this.dateArr[2],m=this.dateArr[3],p=this.dateArr[4],b=this.dateArr[5],v=this.getIndex(u,c),f=this.getIndex(h,n),g=this.getIndex(d,s),k=this.getIndex(m,o),y=this.getIndex(p,i),x=this.getIndex(b,l);const _=function(){v=0,c=u[v]},V=function(){f=0,n=h[f],_()},w=function(){g=0,s=d[g],V()},$=function(){k=0,o=m[k],w()},C=function(){y=0,i=p[y],$()};l!==b[x]&&C(),i!==p[y]&&$(),o!==m[k]&&w(),s!==d[g]&&V(),n!==h[f]&&_();e:for(let j=x;j<b.length;j++){let e=b[j];if(i>p[p.length-1])C();else t:for(let r=y;r<p.length;r++){let l=p[r];if(l=l<10?"0"+l:l,o>m[m.length-1]){if($(),r==p.length-1){C();continue e}}else a:for(let i=k;i<m.length;i++){let o=m[i],b=o<10?"0"+o:o;if(s>d[d.length-1]){if(w(),i==m.length-1){if($(),r==p.length-1){C();continue e}continue t}}else{if(!0!==this.checkDate(e+"-"+l+"-"+b+" 00:00:00")&&"workDay"!==this.dayRule&&"lastWeek"!==this.dayRule&&"lastDay"!==this.dayRule){$();continue t}if("lastDay"==this.dayRule){if(!0!==this.checkDate(e+"-"+l+"-"+b+" 00:00:00"))while(o>0&&!0!==this.checkDate(e+"-"+l+"-"+b+" 00:00:00"))o--,b=o<10?"0"+o:o}else if("workDay"==this.dayRule){if(!0!==this.checkDate(e+"-"+l+"-"+b+" 00:00:00"))while(o>0&&!0!==this.checkDate(e+"-"+l+"-"+b+" 00:00:00"))o--,b=o<10?"0"+o:o;let t=this.formatDate(new Date(e+"-"+l+"-"+b+" 00:00:00"),"week");1==t?(o++,b=o<10?"0"+o:o,!0!==this.checkDate(e+"-"+l+"-"+b+" 00:00:00")&&(o-=3)):7==t&&(1!==this.dayRuleSup?o--:o+=2)}else if("weekDay"==this.dayRule){let t=this.formatDate(new Date(e+"-"+l+"-"+o+" 00:00:00"),"week");if(this.dayRuleSup.indexOf(t)<0){if(i==m.length-1){if($(),r==p.length-1){C();continue e}continue t}continue}}else if("assWeek"==this.dayRule){let t=this.formatDate(new Date(e+"-"+l+"-"+o+" 00:00:00"),"week");o=this.dayRuleSup[1]>=t?7*(this.dayRuleSup[0]-1)+this.dayRuleSup[1]-t+1:7*this.dayRuleSup[0]+this.dayRuleSup[1]-t+1}else if("lastWeek"==this.dayRule){if(!0!==this.checkDate(e+"-"+l+"-"+b+" 00:00:00"))while(o>0&&!0!==this.checkDate(e+"-"+l+"-"+b+" 00:00:00"))o--,b=o<10?"0"+o:o;let t=this.formatDate(new Date(e+"-"+l+"-"+b+" 00:00:00"),"week");this.dayRuleSup<t?o-=t-this.dayRuleSup:this.dayRuleSup>t&&(o-=7-(this.dayRuleSup-t))}o=o<10?"0"+o:o;r:for(let s=g;s<d.length;s++){let b=d[s]<10?"0"+d[s]:d[s];if(n>h[h.length-1]){if(V(),s==d.length-1){if(w(),i==m.length-1){if($(),r==p.length-1){C();continue e}continue t}continue a}}else l:for(let n=f;n<h.length;n++){let f=h[n]<10?"0"+h[n]:h[n];if(c>u[u.length-1]){if(_(),n==h.length-1){if(V(),s==d.length-1){if(w(),i==m.length-1){if($(),r==p.length-1){C();continue e}continue t}continue a}continue r}}else for(let c=v;c<=u.length-1;c++){let v=u[c]<10?"0"+u[c]:u[c];if("00"!==l&&"00"!==o&&(a.push(e+"-"+l+"-"+o+" "+b+":"+f+":"+v),t++),5==t)break e;if(c==u.length-1){if(_(),n==h.length-1){if(V(),s==d.length-1){if(w(),i==m.length-1){if($(),r==p.length-1){C();continue e}continue t}continue a}continue r}continue l}}}}}}}}0==a.length?this.resultList=["没有达到条件的结果！"]:(this.resultList=a,5!==a.length&&this.resultList.push("最近100年内只有上面"+a.length+"条结果！")),this.isShow=!0},getIndex(e,t){if(t<=e[0]||t>e[e.length-1])return 0;for(let a=0;a<e.length-1;a++)if(t>e[a]&&t<=e[a+1])return a+1},getYearArr(e,t){this.dateArr[5]=this.getOrderArr(t,t+100),void 0!==e&&(e.indexOf("-")>=0?this.dateArr[5]=this.getCycleArr(e,t+100,!1):e.indexOf("/")>=0?this.dateArr[5]=this.getAverageArr(e,t+100):"*"!==e&&(this.dateArr[5]=this.getAssignArr(e)))},getMonthArr(e){this.dateArr[4]=this.getOrderArr(1,12),e.indexOf("-")>=0?this.dateArr[4]=this.getCycleArr(e,12,!1):e.indexOf("/")>=0?this.dateArr[4]=this.getAverageArr(e,12):"*"!==e&&(this.dateArr[4]=this.getAssignArr(e))},getWeekArr(e){if(""==this.dayRule&&""==this.dayRuleSup)if(e.indexOf("-")>=0)this.dayRule="weekDay",this.dayRuleSup=this.getCycleArr(e,7,!1);else if(e.indexOf("#")>=0){this.dayRule="assWeek";let t=e.match(/[0-9]{1}/g);this.dayRuleSup=[Number(t[1]),Number(t[0])],this.dateArr[3]=[1],7==this.dayRuleSup[1]&&(this.dayRuleSup[1]=0)}else e.indexOf("L")>=0?(this.dayRule="lastWeek",this.dayRuleSup=Number(e.match(/[0-9]{1,2}/g)[0]),this.dateArr[3]=[31],7==this.dayRuleSup&&(this.dayRuleSup=0)):"*"!==e&&"?"!==e&&(this.dayRule="weekDay",this.dayRuleSup=this.getAssignArr(e))},getDayArr(e){this.dateArr[3]=this.getOrderArr(1,31),this.dayRule="",this.dayRuleSup="",e.indexOf("-")>=0?(this.dateArr[3]=this.getCycleArr(e,31,!1),this.dayRuleSup="null"):e.indexOf("/")>=0?(this.dateArr[3]=this.getAverageArr(e,31),this.dayRuleSup="null"):e.indexOf("W")>=0?(this.dayRule="workDay",this.dayRuleSup=Number(e.match(/[0-9]{1,2}/g)[0]),this.dateArr[3]=[this.dayRuleSup]):e.indexOf("L")>=0?(this.dayRule="lastDay",this.dayRuleSup="null",this.dateArr[3]=[31]):"*"!==e&&"?"!==e?(this.dateArr[3]=this.getAssignArr(e),this.dayRuleSup="null"):"*"==e&&(this.dayRuleSup="null")},getHourArr(e){this.dateArr[2]=this.getOrderArr(0,23),e.indexOf("-")>=0?this.dateArr[2]=this.getCycleArr(e,24,!0):e.indexOf("/")>=0?this.dateArr[2]=this.getAverageArr(e,23):"*"!==e&&(this.dateArr[2]=this.getAssignArr(e))},getMinArr(e){this.dateArr[1]=this.getOrderArr(0,59),e.indexOf("-")>=0?this.dateArr[1]=this.getCycleArr(e,60,!0):e.indexOf("/")>=0?this.dateArr[1]=this.getAverageArr(e,59):"*"!==e&&(this.dateArr[1]=this.getAssignArr(e))},getSecondArr(e){this.dateArr[0]=this.getOrderArr(0,59),e.indexOf("-")>=0?this.dateArr[0]=this.getCycleArr(e,60,!0):e.indexOf("/")>=0?this.dateArr[0]=this.getAverageArr(e,59):"*"!==e&&(this.dateArr[0]=this.getAssignArr(e))},getOrderArr(e,t){let a=[];for(let r=e;r<=t;r++)a.push(r);return a},getAssignArr(e){let t=[],a=e.split(",");for(let r=0;r<a.length;r++)t[r]=Number(a[r]);return t.sort(this.compare),t},getAverageArr(e,t){let a=[],r=e.split("/"),l=Number(r[0]),i=Number(r[1]);while(l<=t)a.push(l),l+=i;return a},getCycleArr(e,t,a){let r=[],l=e.split("-"),i=Number(l[0]),o=Number(l[1]);i>o&&(o+=t);for(let s=i;s<=o;s++){let e=0;0==a&&s%t==0&&(e=t),r.push(Math.round(s%t+e))}return r.sort(this.compare),r},compare(e,t){return t-e>0?-1:1},formatDate(e,t){let a="number"==typeof e?new Date(e):e,r=a.getFullYear(),l=a.getMonth()+1,i=a.getDate(),o=a.getHours(),s=a.getMinutes(),n=a.getSeconds(),c=a.getDay();return void 0==t?r+"-"+(l<10?"0"+l:l)+"-"+(i<10?"0"+i:i)+" "+(o<10?"0"+o:o)+":"+(s<10?"0"+s:s)+":"+(n<10?"0"+n:n):"week"==t?c+1:void 0},checkDate(e){let t=new Date(e),a=this.formatDate(t);return e===a}},watch:{ex:"expressionChange"},props:["ex"],mounted:function(){this.expressionChange()}},ee=Z,te=(0,d.A)(ee,K,X,!1,null,null,null),ae=te.exports,re={data(){return{tabTitles:["秒","分钟","小时","日","月","周","年"],tabActive:0,myindex:0,crontabValueObj:{second:"*",min:"*",hour:"*",day:"*",month:"*",week:"?",year:""}}},name:"vcrontab",props:["expression","hideComponent"],methods:{shouldHide(e){return!this.hideComponent||!this.hideComponent.includes(e)},resolveExp(){if(this.expression){let e=this.expression.split(" ");if(e.length>=6){let t={second:e[0],min:e[1],hour:e[2],day:e[3],month:e[4],week:e[5],year:e[6]?e[6]:""};this.crontabValueObj={...t};for(let e in t)t[e]&&this.changeRadio(e,t[e])}}else this.clearCron()},tabCheck(e){this.tabActive=e},updateCrontabValue(e,t,a){this.crontabValueObj[e]=t,a&&a!==e&&(console.log(`来自组件 ${a} 改变了 ${e} ${t}`),this.changeRadio(e,t))},changeRadio(e,t){let a,r=["second","min","hour","month"],l="cron"+e;if(this.$refs[l]){if(r.includes(e))if("*"===t)a=1;else if(t.indexOf("-")>-1){let e=t.split("-");isNaN(e[0])?this.$refs[l].cycle01=0:this.$refs[l].cycle01=e[0],this.$refs[l].cycle02=e[1],a=2}else if(t.indexOf("/")>-1){let e=t.split("/");isNaN(e[0])?this.$refs[l].average01=0:this.$refs[l].average01=e[0],this.$refs[l].average02=e[1],a=3}else a=4,this.$refs[l].checkboxList=t.split(",");else if("day"==e)if("*"===t)a=1;else if("?"==t)a=2;else if(t.indexOf("-")>-1){let e=t.split("-");isNaN(e[0])?this.$refs[l].cycle01=0:this.$refs[l].cycle01=e[0],this.$refs[l].cycle02=e[1],a=3}else if(t.indexOf("/")>-1){let e=t.split("/");isNaN(e[0])?this.$refs[l].average01=0:this.$refs[l].average01=e[0],this.$refs[l].average02=e[1],a=4}else if(t.indexOf("W")>-1){let e=t.split("W");isNaN(e[0])?this.$refs[l].workday=0:this.$refs[l].workday=e[0],a=5}else"L"===t?a=6:(this.$refs[l].checkboxList=t.split(","),a=7);else if("week"==e)if("*"===t)a=1;else if("?"==t)a=2;else if(t.indexOf("-")>-1){let e=t.split("-");isNaN(e[0])?this.$refs[l].cycle01=0:this.$refs[l].cycle01=e[0],this.$refs[l].cycle02=e[1],a=3}else if(t.indexOf("#")>-1){let e=t.split("#");isNaN(e[0])?this.$refs[l].average01=1:this.$refs[l].average01=e[0],this.$refs[l].average02=e[1],a=4}else if(t.indexOf("L")>-1){let e=t.split("L");isNaN(e[0])?this.$refs[l].weekday=1:this.$refs[l].weekday=e[0],a=5}else this.$refs[l].checkboxList=t.split(","),a=6;else"year"==e&&(""==t?a=1:"*"==t?a=2:t.indexOf("-")>-1?a=3:t.indexOf("/")>-1?a=4:(this.$refs[l].checkboxList=t.split(","),a=5));this.$refs[l].radioValue=a}},checkNumber(e,t,a){return e=Math.floor(e),e<t?e=t:e>a&&(e=a),e},hidePopup(){this.$emit("hide")},submitFill(){this.$emit("fill",this.crontabValueString),this.hidePopup()},clearCron(){this.crontabValueObj={second:"*",min:"*",hour:"*",day:"*",month:"*",week:"?",year:""};for(let e in this.crontabValueObj)this.changeRadio(e,this.crontabValueObj[e])}},computed:{crontabValueString:function(){let e=this.crontabValueObj,t=e.second+" "+e.min+" "+e.hour+" "+e.day+" "+e.month+" "+e.week+(""==e.year?"":" "+e.year);return t}},components:{CrontabSecond:p,CrontabMin:y,CrontabHour:C,CrontabDay:T,CrontabMonth:E,CrontabWeek:W,CrontabYear:B,CrontabResult:ae},watch:{expression:"resolveExp",hideComponent(e){}},mounted:function(){this.resolveExp()}},le=re,ie=(0,d.A)(le,o,s,!1,null,"e1e29174",null),oe=ie.exports,se={components:{Crontab:oe},name:"Job",dicts:["sys_job_group","sys_job_status"],data(){return{loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,jobList:[],title:"",open:!1,openView:!1,openCron:!1,expression:"",queryParams:{pageNum:1,pageSize:10,jobName:void 0,jobGroup:void 0,status:void 0},form:{},rules:{jobName:[{required:!0,message:"任务名称不能为空",trigger:"blur"}],invokeTarget:[{required:!0,message:"调用目标字符串不能为空",trigger:"blur"}],cronExpression:[{required:!0,message:"cron执行表达式不能为空",trigger:"blur"}]}}},created(){this.getList()},methods:{getList(){this.loading=!0,(0,i.Sk)(this.queryParams).then((e=>{this.jobList=e.rows,this.total=e.total,this.loading=!1})).catch((e=>{this.$modal.msgError("服务器错误请联系管理员")}))},jobGroupFormat(e,t){return this.selectDictLabel(this.dict.type.sys_job_group,e.jobGroup)},cancel(){this.open=!1,this.reset()},reset(){this.form={jobId:void 0,jobName:void 0,jobGroup:void 0,invokeTarget:void 0,cronExpression:void 0,misfirePolicy:1,concurrent:1,status:"0"},this.resetForm("form")},handleQuery(){this.queryParams.pageNum=1,this.getList()},resetQuery(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange(e){this.ids=e.map((e=>e.jobId)),this.single=1!=e.length,this.multiple=!e.length},handleCommand(e,t){switch(e){case"handleRun":this.handleRun(t);break;case"handleView":this.handleView(t);break;case"handleJobLog":this.handleJobLog(t);break;default:break}},handleStatusChange(e){let t="0"===e.status?"启用":"停用";this.$modal.confirm('确认要"'+t+'""'+e.jobName+'"任务吗？').then((function(){return(0,i.w2)(e.jobId,e.status)})).then((()=>{this.$modal.msgSuccess(t+"成功")})).catch((function(){e.status="0"===e.status?"1":"0",this.$modal.msgError("服务器出错，请联系管理员！！")}))},handleRun(e){this.$modal.confirm('确认要立即执行一次"'+e.jobName+'"任务吗？').then((function(){return(0,i.uq)(e.jobId,e.jobGroup)})).then((()=>{this.$modal.msgSuccess("执行成功")})).catch((e=>{this.$modal.closeLoading(),this.$modal.msgError("服务器出错，请联系管理员！！！")}))},handleView(e){(0,i.ax)(e.jobId).then((e=>{this.form=e.data,this.openView=!0})).catch((e=>{this.$modal.msgError("服务器出错，请联系管理员！！！")}))},handleShowCron(){this.expression=this.form.cronExpression,this.openCron=!0},crontabFill(e){this.form.cronExpression=e},handleJobLog(e){const t=e.jobId||0;this.$router.push("/monitor/job-log/index/"+t)},handleAdd(){this.reset(),this.open=!0,this.title="添加任务"},handleUpdate(e){this.reset();const t=e.jobId||this.ids;(0,i.ax)(t).then((e=>{this.form=e.data,this.open=!0,this.title="修改任务"})).catch((e=>{this.$modal.msgError("服务器出错，请联系管理员！！！")}))},submitForm:function(){this.$refs["form"].validate((e=>{e&&(void 0!=this.form.jobId?(this.$modal.loading("修改中......"),(0,i.lh)(this.form).then((e=>{this.$modal.closeLoading(),this.$modal.msgSuccess("修改成功"),this.open=!1,this.getList()})).catch((e=>{this.$modal.closeLoading(),this.$modal.msgError("服务器出错，请联系管理员！！！")}))):(this.$modal.loading("新增中......"),(0,i.vO)(this.form).then((e=>{this.$modal.closeLoading(),this.$modal.msgSuccess("新增成功"),this.open=!1,this.getList()})).catch((e=>{this.$modal.closeLoading(),this.$modal.msgError("服务器出错，请联系管理员！！！")}))))}))},handleDelete(e){const t=e.jobId||this.ids;this.$modal.confirm('是否确认删除定时任务编号为"'+t+'"的数据项？').then((function(){return(0,i.b5)(t)})).then((()=>{this.getList(),this.$modal.msgSuccess("删除成功")})).catch((e=>{this.$modal.msgError("服务器出错，请联系管理员！！！")}))},handleExport(){this.download("schedule/job/export",{...this.queryParams},`job_${(new Date).getTime()}.xlsx`)}}},ne=se,ce=(0,d.A)(ne,r,l,!1,null,null,null),ue=ce.exports},5830:function(e,t,a){a.d(t,{Sk:function(){return l},ax:function(){return i},b5:function(){return n},lh:function(){return s},uq:function(){return u},vO:function(){return o},w2:function(){return c}});var r=a(35720);function l(e){return(0,r.Ay)({url:"/schedule/job/list",method:"get",params:e})}function i(e){return(0,r.Ay)({url:"/schedule/job/"+e,method:"get"})}function o(e){return(0,r.Ay)({url:"/schedule/job",method:"post",data:e})}function s(e){return(0,r.Ay)({url:"/schedule/job",method:"put",data:e})}function n(e){return(0,r.Ay)({url:"/schedule/job/"+e,method:"delete"})}function c(e,t){const a={jobId:e,status:t};return(0,r.Ay)({url:"/schedule/job/changeStatus",method:"put",data:a})}function u(e,t){const a={jobId:e,jobGroup:t};return(0,r.Ay)({url:"/schedule/job/run",method:"put",data:a})}}}]);